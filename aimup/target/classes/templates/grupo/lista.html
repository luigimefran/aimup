<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="pt-br">
<head>
  <meta charset="UTF-8">
  <title>Meus Grupos</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body{background:linear-gradient(0deg,#6fbb96 0%,#23a86b 100%);font-family:'Segoe UI',sans-serif;color:#fff;min-height:100vh}
    .card{background-color:rgba(255,255,255,.12);border:none;border-radius:20px;backdrop-filter:blur(5px);color:#fff}
    .card.bg-white{color:#212529}
  </style>
</head>
<body>
<div class="container py-4">

  <div class="d-flex justify-content-between align-items-center mb-3">
    <a class="btn btn-outline-light" href="/"><i class="fa fa-arrow-left"></i> Início</a>
    <h3 class="fw-bold mb-0">Meus Grupos</h3>
    <a class="btn btn-success" href="/grupos/criar-form">+ Criar grupo</a>
  </div>

  <!-- Lista dos grupos do usuário -->
  <div class="card p-4 mb-4">
    <div th:if="${#lists.isEmpty(grupos)}" class="alert alert-light text-dark mb-0">
      Você ainda não participa de nenhum grupo.
      <br>Use a busca abaixo para entrar em um grupo público, ou clique em <strong>Criar grupo</strong>.
    </div>

    <ul class="list-group" th:if="${!#lists.isEmpty(grupos)}">
      <li class="list-group-item d-flex justify-content-between align-items-center"
          th:each="g : ${grupos}">
        <div>
          <strong th:text="${g.nome}">Nome do Grupo</strong><br/>
          <small class="text-muted">ID: <span th:text="${g.id}">1</span></small>
        </div>
        <div class="d-flex gap-2">
          <a class="btn btn-outline-secondary" th:href="@{|/grupos/${g.id}|}">Detalhes</a>
          <a class="btn btn-success" th:href="@{|/tarefas/grupo/${g.id}|}">Ver Tarefas</a>
        </div>
      </li>
    </ul>
  </div>

  <!-- Busca para entrar em grupo -->
  <div class="card p-4 bg-white">
    <h5 class="fw-bold text-success">Entrar em um grupo</h5>

    <form method="get" th:action="@{/grupos}" class="row g-2 mt-2">
      <div class="col-md-10">
        <input class="form-control" type="text" name="q" th:value="${q}" placeholder="Digite o nome do grupo">
      </div>
      <div class="col-md-2 d-grid">
        <button class="btn btn-success">Buscar</button>
      </div>
    </form>

    <div class="mt-3" th:if="${q != null && q != ''}">
      <div th:if="${#lists.isEmpty(resultados)}" class="text-muted">
        Nenhum grupo encontrado para "<span th:text="${q}">q</span>".
      </div>

      <ul class="list-group" th:if="${!#lists.isEmpty(resultados)}">
        <li class="list-group-item d-flex justify-content-between align-items-center"
            th:each="g : ${resultados}">
          <div>
            <strong th:text="${g.nome}">Nome do Grupo</strong><br/>
            <small class="text-muted">ID: <span th:text="${g.id}">1</span></small>
          </div>
          <div>
            <form th:action="@{/grupos/entrar}" method="post" class="d-inline">
              <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
              <input type="hidden" name="grupoId" th:value="${g.id}">
              <button class="btn btn-success">Entrar</button>
            </form>
          </div>
        </li>
      </ul>
    </div>
  </div>

</div>
</body>
</html>
